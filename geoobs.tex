\documentclass{patmorin}
\listfiles
\usepackage[utf8]{inputenc}
\usepackage{microtype}
\usepackage{amsthm,amsmath,graphicx}
\usepackage{pat}
\usepackage[letterpaper]{hyperref}
\usepackage[table,dvipsnames]{xcolor}
\definecolor{linkblue}{named}{Blue}
\hypersetup{colorlinks=true, linkcolor=linkblue,  anchorcolor=linkblue,
citecolor=linkblue, filecolor=linkblue, menucolor=linkblue,
urlcolor=linkblue} 
\setlength{\parskip}{1ex}
\usepackage{wasysym}

\title{\MakeUppercase{Geodesic Obstacle Representations of Graphs}}

\author{Pat Morin and Friends}%

%\usepackage[mathlines]{lineno}
%\linenumbers
%\setlength{\linenumbersep}{2.5cm}
%\rightlinenumbers
%\linenumbers
%\newcommand*\patchAmsMathEnvironmentForLineno[1]{%
%  \expandafter\let\csname old#1\expandafter\endcsname\csname #1\endcsname
%  \expandafter\let\csname oldend#1\expandafter\endcsname\csname end#1\endcsname
%  \renewenvironment{#1}%
%     {\linenomath\csname old#1\endcsname}%
%     {\csname oldend#1\endcsname\endlinenomath}}% 
%\newcommand*\patchBothAmsMathEnvironmentsForLineno[1]{%
%  \patchAmsMathEnvironmentForLineno{#1}%
%  \patchAmsMathEnvironmentForLineno{#1*}}%
%\AtBeginDocument{%
%\patchBothAmsMathEnvironmentsForLineno{equation}%
%\patchBothAmsMathEnvironmentsForLineno{align}%
%\patchBothAmsMathEnvironmentsForLineno{flalign}%
%\patchBothAmsMathEnvironmentsForLineno{alignat}%
%\patchBothAmsMathEnvironmentsForLineno{gather}%
%\patchBothAmsMathEnvironmentsForLineno{multline}%
%}


\newcommand{\question}[1]{\textbf{\color{red}Question:}~#1}

\DeclareMathOperator{\ob}{obs}
\DeclareMathOperator{\planeobs}{plane-obs}

\newcommand{\eps}{\epsilon}

\pagenumbering{roman}
\begin{document}
\begin{titlepage}
\maketitle

\begin{abstract}
  We introduce the notion of geodesic obstacle representations of graphs,
  which generalizes and unifies the notions of obstacle representations,
  planar obstacle representations, and grid obstacle representations.
  It also leads to a plethora of questions on embedding 
\end{abstract}
\end{titlepage}

\tableofcontents

\newpage


\section{Introduction}
\pagenumbering{arabic}

An obstacle representation of an (undirected simple) graph $G$ is
pair $(\varphi, S)$ where $\varphi:V(G)\to\R^2$ maps vertices of $G$
to distinct points in $\R^2$ and $S$ is a set of connected subsets of
$\R^2$ with the property that, for every $u,w\in V(G)$, $uw\in E(G)$
if and only if the line segment $\varphi(u)\varphi(w)$ is disjoint from
$\cup S$.  The elements of $S$ are called \emph{obstacles}.

It is easy to see that every graph $G$ has an obstacle representation:
Take any $\varphi$ that does not map three vertices of $G$ onto a single
line. This gives a straight-line drawing of $G$ whose edges form an
arrangement of line segments.  Now take $S$ to consist of the open faces
in this arrangement.  Since every graph has an obstacle representation,
this defines a natural graph parameter called the \emph{obstacle number}:
\[
     \ob(G) = \min\{|S| :\text{$(\varphi, S)$ is an obstacle representation of $G$}\} \enspace .
\]
Since their introduction by So and So, obstacle numbers have been studied
extensively, with the main goal of bounding the obstacle numbers of
various classes of graphs.  It is known that every $n$-vertex graph has
obstacle number $O(n\log n)$ \cite{X} and some $n$-vertex graphs have
obstacle number $\Omega(n/(\log\log n)^2)$ \cite{Y}.  For planar graphs,
our understanding is muddier: There exists planar graphs with obstacle
number 2 \emph{X} (the icosahedron is an example), but the best upper
bound on the obstacle number of an $n$-vertex planar graph is $O(n)$.

For planar graphs there is also a natural notion of a \emph{plane obstacle
representation} $(\varphi, S)$ which is an obstacle representation
in which $\varphi$ defines a plane straight-line embedding of $G$.
This leads to a \emph{plane obstacle number}
\[
    \planeobs(G) = \min\{|S| :\text{$(\varphi, S)$ is a plane obstacle
        representation of $G$}\} \enspace .
\]
Using Euler's Formula, it is not hard to see that the plane obstacle
number of any $n$-vertex planar graph is $O(n)$: Let $\varphi$ define
any plane drawing of $G$ with no three vertices collinear and take $S$
to be the set of open faces in this drawing.  Since an $n$-vertex planar
graph has at most $2n-4$ faces, this implies $\planeobs(G)\le 2n-4$.
A lower bound of $\Omega(n)$ is also not difficult:  Any plane drawing
of the $\sqrt{n}\times\sqrt{n}$ grid $G_{\sqrt{n}\times\sqrt{n}}$
has at least $n-2\sqrt{n}$ bounded faces. Each of these faces has
at least four vertices and therefore requires at least one obstacle,
so $\planeobs(G_{\sqrt{n}\times\sqrt{n}})\ge n-2\sqrt{n}$.  So and so
\cite{X} have nailed the leading constant by showing that every planar
graph has obstacle number at most $n-x$ and some planar graphs have
obstacle number $n-x$.

\subsection{A Generalization}

In this paper we study a natural generalization of obstacle
representations that comes from viewing line segments as shortest paths
in the Euclidean plane.  An obstacle representation has the property that
$uw\in E(G)$ if and only if the shortest path from $\phi(u)$ to $\phi(w)$
does not intersect $\cup S$.

The Euclidean distance is a very special case because the shortest path
between any two points $p$ and $q$ is unique, so we could modify the
definition of obstacle representation to say that $uw\in E(G)$ if and
only if some shortest path from $\phi(u)$ to $\phi(w)$ does not intersect
$\cup S$.

\ldots

In this way, we can obtain many generalizations of obstacle
representations by changing the underlying distance measure.  For example,
with the $L_1$ (Manhattan) distance measure, every x-y-monotone
path is a shortest path.  Therefore, if $(\varphi,S)$ is an $L_1$
obstacle representation, then an edge $uw\in E(G)$ if and only if every
x-y-monotone path from $\phi(u)$ to $\phi(w)$ intersects $\cup S$.  One
immediate consequence of this is that it is
no longer obvious that every graph has an $L_1$ obstacle representation.

In this paper we study these generalized obstacle representations
(mainly) using polyhedral distance functions\footnote{Say something
about polyhedral distance functions here.} in $\R^d$ and (less so)
using shortest path distances in graphs.  

For obstacle representations using a polyhedral distance function, $\delta$,
it turns out that the number, $2k$, of facets in the polytope $P_\delta=\{ x: \delta(\mathbf{0},x\}\le 1\}$ is a critical parameter. 

\begin{enumerate}
  \item In $\R^2$, every $k$-vertex graph has a $\delta$ obstacle
  representation for $k\ge n$

  \item In $\R^2$, there exists $O(k^2)$-vertex graphs with no $\delta$
  obstacle representation.

  \item For any dimension $d\ge 3$ and any polyhedral distance function
  $\delta$ over $\R^d$, there exists a graph that does not have a $\delta$
  obstacle representation.  More concretely, 
  \begin{enumerate}
     \item Every $n$-vertex graph with $n\le 2^k$ has a $\delta$
     obstacle representation.
     \item There is a universal constant $c$ (independent of $k$) such
     that there exists an $c^k$-vertex graph that does not have a $\delta$
     obstacle representation.
  \end{enumerate}
\end{enumerate}

Talk about planar representations


Finally talk about graphs



Do the formal stuff later\ldots


We would like to generalize the notion of obstacle numbers to metric
spaces other than $\R^2$ with the Euclidean distance metric.  Before we
can do this, though, we need a notion of a metric space that is also
equipped with some topology.

Let $(X,d)$ be a metric space.  A \emph{curve} over $X$ is a function
$f:[0,1]\to X$.  We call $f(0)$ and $f(1)$ the \emph{endpoints} of the
curve $f$ and define the \emph{image} of $f$ as $I(f)=\{f(t):0\le t\le
1\}$.  A curve $f$ is a \emph{geodesic} if, for every $0\le t\le 1$,
$d(f(0),f(t)) + d(f(t),f(1)) = d(f(0),f(1))$.  


A \emph{path space} is a triple $(X,d,C)$, where $(X,d)$ is a metric
space and $C$ is a set of curves over $X$ that has the following closure
property:  If the curve $f$ is in $C$ then, for every $0\le t\le 1$,
$C$ also contains the curves $g(x)=f(x/t)$ and $h(x)=f(t+x/(1-t)$.
A path space $(X,d,C)$ is \emph{connected} if, for every distinct pair
$u,w\in X$, there is some path in $C$ with endpoints $u$ and $w$.

In a path space $(X,d,C)$, we say that
two curves $f,g\in C$ \emph{cross} if there exists $0<s<1$ and $0<t<1$ such
that the curve
\[
    h(x) = \begin{cases} 
             f(x) & \text{for $0\le x< s$} \\
             g(t+(x-s)(1-t)/(1-s)) & \text{for $s\le x\le 1$} \enspace .
           \end{cases}
\]
is also in $C$. In words: $f$ and $g$ cross if we can make a new curve
consisting of some prefix of $f$ concatenated with some tail of $g$.


For a path space $P=(X,d,C)$ and a subset $S\subset X$, we denote the
subspace induced by $S$ as $P[S]=(S,d,\{f\in C:I(f)\subseteq S\})$.  The
subspace that avoids $S$ is defined ias $P\setminus S = P[X\setminus S]$.

As examples, we can $X=\R^2$ and $C$ to be the set of all closed
continuous curves over $\R^2$.  Now, if we take $d$ to be the Euclidean
metric, then the geodesics in $C$ are straight line segments.  A more
interesting example (and one we will study) is when we take $d$ to be
the $L_1$ (Manhattan) distance, in which case the geodesics in $C$ are
x-y-monotone paths.  As a discrete example, we could take $X$ to be the
vertex set of some graph $G$, $d(p,q)$ to be distance in $G$ from $p$
to $q$, and $C$ to be the set of all paths in $G$. In this case the
geodesics in $C$ are the shortest paths in $G$.

With these definitions in hand, we are ready to define a generalization
of obstacle representations.

\begin{defn}
An \emph{$(X,d,C)$ obstacle representation} of a graph $G$ is a pair
$(\varphi, S)$ where $\varphi:V(G)\to X$ is a one-to-one mapping and
$S$ is a set of connected subsets of $X$ with the property that, for
every $u,w\in V(G)$, $uw\in E(G)$ if and only if $C$ contains a $\cup
S$-avoiding geodesic with endpoints $\varphi(u)$ and $\varphi(w)$.
\end{defn}

Note that, for a given $(X,d,C)$ it is not at all obvious whether every
graph $G$ has an \emph{$(X,d,C)$ obstacle representation}.  Indeed,
the focus of this paper is to determine, for a class $\mathcal{G}$ of
graphs and a particular path space $(X,d,C)$, whether or not every
member of $\mathcal{G}$ has an $(X,d,C)$ obstacle representation.
As it happens, this question is closely related to certain types of
embeddings of $G$ into $X$.

An \emph{embedding} $(\varphi,c)$ of a graph $G$ into $X$ consists
of a one-to-one map $\varphi:V(G)\to X$ and a function $c: E(G)\to
\mathcal{C}(X)$.  The embedding is \emph{geodesic} if, for every $uw\in
E(G)$, $c(uw)$ is a geodesic.  

TODO: Non-crossing should mean something else.
The embedding is \emph{non-crossing} if,
for every $uw,xz\in E(G)$ with $\{u,w\}\cap \{x,z\}=\emptyset$, $c(uw)$
is disjoint from $c(xz)$.  Note that this definition says nothing about
two edges that share a common vertex.

Given a $(X,d,C)$ obstacle representation $(\varphi,S)$ of $G$, we can
choose, for each $uw\in E(G)$, some $S$-avoiding geodesic $c(uw)\in C$
with endpoints $\varphi(u)$ and $\varphi(w)$.  The pair $(\varphi,c)$
then gives a geodesic embedding of $G$ into $X$.  If it is possible to
choose $c$ so that $(\varphi,c)$ is also non-crossing, then we say that
the representation $(\varphi,S)$ is non-crossing.




In this paper, we mostly focus on non-crossing $(X,d,C)$ obstacle
representations where $X=\R^p$, $d$ is some polygonal distance function
(defined next), and $C=\mathcal{C}_p$ is the set of closed continuous
curves over $\R^p$.  For a set $N=\{v_0,\ldots,v_{t-1}\}$ of vectors in
$\R^p$, we define the \emph{polyhedral distance function}
\[  
   d_N(p,q)=\min\left\{\sum_{i=0}^{t-1}|a_i|: 
                        q-p=\sum_{i=0}^{t-1}a_iv_i\right\} \enspace ,
\]
Every such distance function defines a centrally symmetric polyhedron
\[
   P_N=\{x\in\R^p: d_N(\mathbf{0},x)\le 1\}  \enspace .
\]
For the special case $p=2$, we define, for each integer $k\ge 2 \in N$,
the regular distance function $d_k=d_{N_k}$, where $N_k=\{(\cos(i\pi/k),
\sin(i\pi/k)): i\in\{0,\ldots,k-1\}$.  In this case, the associated
polygon $P_k$ is a regular $2k$-gon.

For the sake of compactness, we use \emph{$d_k$ obstacle representation}
as shorthand for $(\R^2,d_k,\mathcal{C}_2)$ obstacle representation.
We prove the following results:
\begin{enumerate}
   \item For any integer $k$, there is a graph with $O(k^2)$ vertices
     that does not have a $d_k$ obstacle representation. 

   \item Every $n$-vertex graph has a $d_k$-obstacle representation for 
     every $k\ge n$.

   \item For any $p\in N$ and any finite set $N$ of vectors in $\R^p$,
    there exists a graph that does not have an $(\R^p,d_N,\mathcal{C}_p)$
    obstacle representation.

   \item Every $n$-vertex graph has a $(\R^3,d_N,\mathcal{C}_3)$ obstacle
    representation with $|N|=\lceil(1/2)\log_2 n\rceil +2\rceil$.


   \item In dimensions $d\ge 3$, there exists

   \item Every planar graph of treewidth at most 2 (and hence every
     outerplanar graph) has a non-crossing $d_2$ obstacle
     representation.
   \item Not every planar 3-tree has a non-crossing $d_2$
     obstacle representation.
   \item Not every planar 4-connected triangulation has a 
     non-crossing $d_2$ obstacle representation.
   \item Every planar graph of treewidth at most 3 has a 
     non-crossing $d_3$ obstacle representation.
   \item Every planar graph has a non-crossing $d_?$
     obstacle representation.
\end{enumerate}

\subsection{Related Work}

Biedl and Mehrabi study so-called grid obstacle representations \cite{X}...


\section{Preliminaries}

Here we present some definitions and observations that are useful
throughout the rest of the paper.  

Path spaces are so general that there are unlikely to be very few
universal results about them.  However, the following is one such
useful result:

\begin{obs}\obslabel{induced}
   If a graph $G$ has a $(X,d,C)$ obstacle representation
   $(\varphi,S)$, then   $(\varphi, S)$ is also a $(X,d,C)$ obstacle
   representation for every induced subgraph of $G$.
\end{obs}

\obsref{induced} follows immediately from the fact that, for two vertices
$u$ and $w$ in the induced subgraph $G'$, $uw\in E[G']$ if and only if
$uw\in E[G]$.

TODO: Say something about generic representations.


%Next, we justify a form of generic position assumption that
%simplifies discussions later.  We say that a set of points in $\R^2$
%is \emph{$d_k$-generic}, if it contains no pair of distinct $p$ and $q$
%such that $p-q= t(\cos(i\pi/k),\sin(i\pi/k)$ for some integer $i$.
%
%\begin{obs}\obslabel{generic}
%  If $G$ has a $d_k$ obstacle representation, then it
%  has an $d_k$ obstacle representation $(\varphi, S)$
%  in which $\{\varphi(u):u\in V(G)\}$ is $d_k$-generic.
%\end{obs}
%
%\begin{proof}[Proof Sketch]
%   Consider all the $2kn$ lines that determine $d_k$ genericness.
%   For every point $p$ on one of these lines, $\ell$ that is not
%   part of any obstacle, we remove an $\eps$-length line segment
%   centered at $p$ and perpendicular to $\ell$. The result is still
%   an $d_k$ obstacle representation of $G$.  Now we can
%   perform a sufficiently small rotation of the entire representation
%   so that it becomes $d_k$-generic.
%\end{proof}
%
%Justified by \obsref{generic} we will, from this point onwards
%assume that any obstacle representation is $d_k$ generic (for the
%appropriate value of $k$) and that the tangent vector to any point on
%any geodesic does not form an angle of $i\pi/k$ with the x-axis, for
%any $i\in\{0,\ldots,2k-1\}$.

\subsection{Polyhedral geodesics}

Recall that every polyhedral metric $d_N$ has an associated polyhedron
$P_N$.  The faces of $P_N$ are very important, because they determine the
geodesics.  For a (closed) facet $F$ of $P_N$ we denote the \emph{cone}
$C_F$ as the union of all rays originating at the origin and containing
a point on $F$ (this is the affine hull of $F$).  For a point $x\in\R^p$,
the \emph{$F$-sector} of $x$ is $Q^N_F(x)=C_F+x$.

For a facet of $F$ of $P_N$, we say that a curve $f$ is
\emph{$d_N$-monotone in direction $F$} if, for all $0\le a\le b\le 1$,
$f(b)\in Q^N_F(f(a))$.  We say that a curve is $d_N$-\emph{monotone} if it
is $d_N$-monotone in direction $F$ for some facet $F$ of $P_N$.  Observe
that a curve $f$ is a geodesic for $d_N$ if and only if $f$ is $d_N$-monotone.

We will now begin the convention of naming our geodesic by their
endpoints, so that a geodesic $uw$ is a geodesic with endpoints $u$
and $w$. We will also use the ordering of these endpoints to indicate
some form of direction so that, for example, if we say that that $uw$
is $d_N$-monotone in direction $F$, this means that $w\in Q^N_F(u)$.

\begin{obs}\obslabel{quadrilateral}
   If $uw$ and $xz$ are curves that are each $k$-monotone direction in $i$
   and $uw\cap xz$ contains at least one point $p$, then $d_k(u,z) =
   d_k(u,p)+d_k(p,z)$ and $d_k(x,w)=d_k(x,p)+d_k(p,w)$.
\end{obs}

\subsection{$k$-Monotone Embeddings}

An embedding $(\varphi,c)$ of a graph $G$ into $\R^2$
is \emph{plane} if, for every edge $uw\in E(G)$, $c(uw)$
is disjoint from $\{\varphi(x) : x\in V(G)\setminus\{u,w\}\}$
and, for each pair of distinct edges $uw,xz\in E(G)$, $c(uw)\cap
c(xz)\subseteq\{\varphi(u),\varphi(w),\varphi(x),\varphi(z)\}$. 
From this point onwards, when we are discussing a particular embedding
of $G$, we will identify each vertex $u$ of $G$ with $\varphi(u)$ and
each edge $uw$ of $G$ with the curve $c(uw)$.

\begin{defn}
An embedding of $G$ into $\R^2$ is a \emph{$d_k$-obstacle embedding}
if each edge $uw$ of $G$ is $k$-monotone and, for each $u,w\in V(G)$,
the embedding contains a $k$-monotone path from $u$ to $w$ if and only
if $uw\in E(G)$.
\end{defn}

Note that, from a $d_k$ obstacle representation $(\varphi, S)$ we
can obtain a $d_k$ obstacle embedding $(\varphi, c)$ by taking each
$c(uw)$ to be any $S$-avoiding geodesic with endpoints $u$ and $w$.
However, the converse is not necessarily true.  Given a $d_k$ obstacle
embedding of $G$, taking $S=\R^2\setminus (\bigcup_{uw\in E(G)}c(uw))\cup
(\bigcup_{u\in V(G)} \phi(u)$ does not necessarily yield a $d_k$ obstacle
representation $(\varphi,S)$ of $G$.  The problem occurs because of
\obsref{quadrilateral} when two edges $uw$ and $xz$ are both $k$ monotone in
direction $i$ and they cross. This leaves $S$-avoiding geodesics from $u$
to $z$ and $x$ to $w$ even though $uz$ and $xw$ may not be edges of $G$.



\section{General Representations}

\subsection{$\R^2$}

Our first result is a negative one:

\begin{thm}\thmlabel{plane-lower-bound}
  There exists a constant $a>0$ such that, for every $k\in \N$, and every
  $n\ge ak^2$, there exist an $n$-vertex bipartite graph $G$ with maximum
  degree $O(k)$ that has no $d_k$ obstacle representation.
\end{thm}

\begin{proof}
   Erd\H{o}s, R\'enyi, and S\'os \cite{erdos.renyi.ea:1966} showed that,
   for some $c>0$, for every $n\ge 2$, there exists a bipartite graph
   $G$ with $n$ vertices $cn^{3/2}$ edges, maximum degree $cn^{1/2}$
   and that contains no $K_{2,2}$ subgraph.  Let $(\varphi,S)$ be a
   $d_k$ obstacle representation and let $(\varphi,c)$
   be an embedding of $G$ obtained by taking $c(uw)$ to be some shortest
   $S$-avoiding path from $\varphi(u)$ to $\varphi(w)$.

   Each edge $uw\in E(G)$ is $k$-monotone in direction $i$ for some
   $i\in\{0,\ldots,k-1\}$.  By the pigeonhole principle, there is
   some direction $i$ for which at least $cn^{3/2}/k\ge acn$ edges
   are monotone in direction $i$.  By Euler's formula, if $ac\ge 3$,
   the graph consisting only of these edges is not planar, therefore
   there is some pair of edges $uw$ and $xz$ that are both monotone in
   direction $i$ and that have some point $p$ in common.

   But now we have $d(u,z)=d(u,p)+d(p,z)$.  Therefore, there is a shortest
   $S$-avoiding path from $u$ to $z$, so $uz\in E(G)$.  Similarly, there
   is a shortest $S$-avoiding path from $x$ to $w$, so $xw\in E(G)$.
   But this is a contradiction since it implies that $u$, $w$, $x$,
   and $z$ form a $K_{2,2}$.
\end{proof}

As $k\to\infty$, $d_k$ becomes the usual Euclidean distance function
and $d_k$-obstacle representations are just the usual obstacle
representations, which we know every graph has.  Thus, for every $n\in
N$, there is a threshold value $k(n)$ such that every $n$-vertex graph
has a $d_{k(n)}$ obstacle representation.  \thmref{plane-lower-bound}
shows that $k(n)\in \Omega(\sqrt{n})$, and the following theorem shows
$k(n)\in O(n)$.

\begin{thm}
   Every $n$-vertex graph $G$ has a $d_k$ obstacle representation for $k=\lceil n/2\rceil$.
\end{thm}

\begin{proof}
   Consider the regular $2k$-gon with vertices at $(\cos((i+1/2)\pi/k),
   \sin((i+1/2)\pi/k))$, for $i\in\{0,\ldots,2k-1\}$.  It is well known
   that the pairs of vertices of this $2k$-gon determine only $k$
   distinct directions and that these directions are $(i+1/2)\pi/k$
   for $i=\{0,\ldots,k-1\}$.

   Therefore, to take obtain an obstacle representation of $G$, place
   its vertices on this regular 2k-gon, join its vertices with straight
   line segments and take the obstacles to be the faces of the resulting
   arrangement of line segments.  That this is an obstacle representation
   follows from the fact that no $k$-monotone path uses two different
   directions determined pairs of vertices and no two edges in the same
   direction cross each other.
\end{proof}

\question{Determine the growth of $k(n)$.}

The graphs in the proof of \thmref{plane-lower-bound} have $\Omega(kn)$
edges and therefore have vertices of degree $\Omega(k)$.  

\question{Is it true that, for every $\Delta$, there exists a $k(\Delta)$ such that every graph with maximum degree $\Delta$ has a $d_{k(\Delta)}$ obstacle representation?}


\subsection{$\R^d$}

The proof of \thmref{plane-lower-bound} makes critical use of the
fact that $d_k$ obstacle representations live in the plane so that
any sufficiently dense (sub)graph has a pair of edges that cross. An
obvious question then is whether every graph has $(\R^3,d_{\hexagon},C_3)$
obstacle representation, where $d_{\hexagon}$ is some polyhedral distance
function and $C_3$ is the set of closed connected curves in $\R^3$.
The answer is no.


\begin{thm}\thmlabel{rd-lower-bound}
  For every $p\in\N$, and every polyhedral distance function
  $d_{\hexagon}$ over $\R^d$, there exists a graph $G$ that has no $(\R^p,
  d_{\hexagon}, C_p)$ obstacle representation.
\end{thm}


\begin{proof}
  Let $G$ be an $n$-vertex graph with no clique and no independent set of
  size larger than $2\log n$. The existence of such graphs was shown by
  Erd\H{o}s and Renyi \cite{X}. Suppose, for the sake of contradiction,
  that $G$ has some $(\R^p, d_{\hexagon}, C_p)$ obstacle representation
  $(\varphi,S)$. Let $\prec$ denote lexicographic order over points
  in $\R^{p}$.

  Now, the polyhedral distance function $d_{\hexagon}$
  defines some centrally symmetric polyhedron
  $P=\{x\in\R^3:d_{\hexagon}(\mathbf{0},x)\le 1\}$.  For any $u,w\in
  \R^p$ with $u\prec w$, the scaled and translated polyhedron
  $P_{uw}=u+d_{\hexagon}(u,w)\cdot P$ contains the point $w$ on its
  boundary.  If $P$ has $k$ facets, this defines a $k$-colouring of
  the ordered pairs of vertices of $G$, where $uw$, with $u\prec w$,
  is colored by the facet of $P_{uw}$ that contains $w$.  (If $w$
  is incident to more than one facet of $P_{uw}$, then choose one
  arbitrarily to determine the colour of $uw$.)

  For each $i\in\{1,\ldots,k\}$, let $\prec_i$ denote the partial
  order obtained by restricting the total order $\prec$ to the pairs of
  vertices in $G$ with colour $i$.  We claim that for at least one $i$,
  $\prec_i$ contains a chain $v_1\prec_i\cdots\prec_i v_r$ of length
  $r\ge n^{1/k}$.  To see why this is so, observe that, by Dilwerth's
  Theorem, if $\prec_k$ does not contain a chain of length $n^{1/k}$,
  then it contains an antichain $A_k$ of size $n^{1-1/k}$.  Now proceed
  inductively on $\prec_1,\ldots,\prec_{k-1}$ and $A_k$, observing that
  every pair in $A_k$ is coloured with $\{1,\ldots,k-1\}$.

  Back to our embedding, the sequence $v_1,\ldots,v_r$ is such that for
  any $i<j<k$, the union of a geodesic $f_{ij}$ with endpoints $v_i$
  and $v_j$ and a geodesic $f_{jk}$ with endpoints $v_j$ and $v_k$
  is a geodesic with endpoints $v_i$ and $v_k$.
  
  So now, consider the subgraph $G'$ of $G$ induced by
  $v_1,\ldots,v_r$. From the preceding discussion, it follows that $G$
  is a collection of vertex-disjoint cliques.  But this means that
  $G'$ (and hence $G$) must contains a clique of size $\sqrt{r}$ or
  an independent set of size $\sqrt{r}$.  Recall that $r\ge
  n^{1/k}$, so this contradicts our choice of $G$, if $n^{1/2k} \ge
  2\log n$, which is true for all sufficiently large $n$.
\end{proof}


The proof of \thmref{rd-lower-bound} shows that, for some $n$-vertex
graphs $G$, any $(\R^p, d_{\hexagon}, C_p)$ obstacle representation of $G$
must use a distance function $d_{\hexagon}$ with $k=\Omega(\log n)$ facets.
Our next result shows that, even in $\R^3$, a polyhedral distance function with $k=O(\log n)$ facets is sufficient.

\begin{thm}\thmlabel{3d-universal}
   Let $d_{\hexagon}$ be any polyhedral distance function in $\R^p$ for
   which the polyhedron $P_{\hexagon}=\{x\in\R^p:d_{\hexagon}(\mathbf{0},x)\le
   1\}$ has at least $2\log_2 n$ facets.  Then every $n$-vertex graph $G$
   has a $(\R^p,d_{\hexagon},C_3)$ obstacle representation.
\end{thm}

\begin{proof}
   We claim that there exists a general position point set $X\subset\R^p$
   of size at least $n$ with the property that no geodesic contains
   3 points of $X$.  Given such a point set, we obtain an embedding
   $(\varphi,c)$  of $G$ by letting $\varphi$ be any one-to-one mapping
   of $V(G)$ onto $S$ and letting, for each $uw\in E(G)$, $c(uw)$ be
   the line segment with endpoints $u$ and $w$.  In this way, no path
   of length 2 or more in $G$ becomes a geodesic, so $(\varphi,c)$ is
   a $(\R^3,d_{\hexagon},C_3)$ obstacle embedding of $G$.  Furthermore,
   since $X$ is in general position, no two edges of the embedding cross.
   Therefore, taking $S=\R^3\setminus \bigcup_{uw\in E(G)} c(uw)$ yields
   an $(\R^3,d_{\hexagon},C_3)$ obstacle representation $(\varphi,S)$
   of $G$.

   All that remains is to show the existence of the set $X$.  In the
   following, we will ignore the general position requirement on $X$,
   since it will be clear that the set $X$ we find can be slightly
   perturbed to ensure it is in general position.

   Since $d_{\hexagon}$ is a distance function, and hence symmetric,
   the polyhedron $P_{\hexagon}$ is symmetric, so the facets of $P$
   come in $k\ge \log_2 n$ opposing pairs, let $\{f_1,\ldots,f_{k}\}$
   contain one representative facet from each such pair, and let
   $\{c_1,\ldots,c_{k}\}$ be a set of balls, where each ball $c_i$ is
   contained in the interior of $f_i$. Finally, let $\{L_1,\ldots,L_{k}\}$
   be a set of sets of lines, where each $L_i$ contains all lines
   through the origin that intersect $c_i$.  Note that, since the
   balls $c_1,\ldots,c_{k}$ are disjoint, so are the line sets
   $L_1,\ldots,L_{k}$.

   It suffices to construct a point set $X$, $|X|=2^{k}$, such that,
   for any triple $u,x,w\in X$, there exists $i,j\in\{1,\ldots,k\}$,
   $i\neq j$, such that $ux$ is parallel to some line in $L_i$ and $xw$ is
   parallel to some line in $L_j$.  We construct such a set inductively.
   If $k=0$, $X=\{\textbf{0}\}$ satisfies our requirements.

   For $k\ge 2$, apply induction to obtain a set of points $X'$,
   $|X'|=2^{k-1}$ such that, for any triple $u,x,w\in X'$, there exists
   $i,j\in\{2,\ldots,k\}$, $i\neq j$, such that $ux$ is parallel to
   some line in $L_i$ and $xw$ is parallel to some line in $L_j$.  Now,
   choose two balls $A$ and $B$ such that, for every pair of points
   $u\in A$, $w\in B$, $u-w$ is parallel to some line in $L_{1}$.
   Finally, scale and translate $X'$ to obtain point set $X'_A\subset
   A$ and another point set $X'_B\subset B$ and take $X=X'_A\cup X'_B$.
   Clearly $|X|=2^k$.  By the inductive hypothesis, if $\{u,x,w\}\in X'_A$
   of $\{u,x,w\}\in X'_B$, then $ux$ is parallel to some line $L_i$ and
   $xw$ is parallel to some line in $L_j$, with $i,j\in\{2,\ldots,k\}$,
   $i\neq j$.  Otherwise, assume without loss of generality that $u\in
   X'_A$ and $x,w\in X'_B$.  Then $u-x$ is parallel to some line in $L_1$
   and $x-w$ is parallel to some line $L_j$ for some $j\in\{2,\ldots,k\}$.
\end{proof}

If we take $t$ generic unit vectors in $\R^3$, then the polyhedral
distance function determined by these vectors defines a polyhedron having
$2t$ vertices and $4t-8$ triangular faces.  \thmref{3d-universal}
therefore implies that a polyhedral distance function determined by
$t\ge (1/2)\log_2 n +2$ unit vectors is sufficient to allow an obstacle
representations of any $n$-vertex graph.



\section{Non-Crossing Representations}

In this section, we consider non-crossing $d_k$ obstacle
representations. The following lemma shows that these representations
are equivalent to plane $d_k$ obstacle embeddings.

\begin{lem}\lemlabel{monotone}
   A graph $G$ has a non-crossing $d_k$ obstacle representation if and
   only $G$ has a plane $d_k$ obstacle embedding.
\end{lem}

\begin{proof}
   First, suppose $G$ has a plane $d_k$-obstacle embedding $(\varphi,c)$.
   Then we claim that by taking $S= \R^2\setminus \bigcup_{uw\in E(G)}
   c(uw)\cup \bigcup_{u\in V(G)}\varphi(u)$, we obtain an obstacle
   representation $(\varphi,S)$ .

   If $uw\in E(G)$ then $uw$ is an $S$-avoiding $k$-monotone curve.
   On the other hand if $uw\not\in E(G)$ then, since $(\varphi,c)$
   is plane, any $S$-avoiding $k$-monotone curve with endpoints $u$
   and $w$ would determine a $k$-monotone path from $u$ to $w$ in $G$.
   The definition of $d_k$ obstacle embedding does not allow this.

   Next we argue that a $d_k$ non-crossing obstacle representation
   $(\varphi, S)$ implies the existence of a plane $d_k$-obstacle
   embedding $(\varphi, c')$ of $G$.  of $G$.  By the
   definition of non-crossing, we immediately obtain a function
   $c:E(G)\to\mathcal{C}(\R^2)$ that maps edges of $G$ onto geodesic
   curves joining their endpoints, and any two of these curves are
   disjoint unless they share a common endpoint.

   The resulting embedding $(\varphi,c)$ is almost a plane $d_k$-obstacle
   embedding except that it may contains pairs of edges $ux$ and $uz$
   such that $c(ux)$ and $c(uz)$ cross each other.  In this case,
   we observe that both $ux$ and $uz$ are $k$-monotone in direction
   $i$ for the same value of $i$.  This makes it easy to eliminate
   crossings by repeatedly swapping segments of the curves and making
   local modifications around the crossings.  Repeating this for every
   crossing pair of edges gives a plane $d_k$ obstacle embedding of $G$.
\end{proof}

\lemref{monotone} allows us to focus our effort on studying the existence
(or not) of plane $d_k$-obstacle embeddings.  This is what we do for
the rest of paper, beginning with plane $d_k$-obstacle representations
of small treewidth graphs.

\subsection{Treewidth}

Some of our results look at the relation between plane $d_k$ obstacle
embeddings and the treewidth of $G$.  A \emph{$k$-tree} is any graph that
can be obtained in the following manner:  We begin with a clique on $k+1$
vertices and then we repeatedly select a subset of the vertices that
form a $k$-clique $K$ and add a new vertex adjacent to every element
in $K$.  The class of $k$-trees is exactly the set of edge-maximal
graphs of treewidth $k$.  We will make use of the following lemma,
due to Dujmovi\'c and Wood \cite[Lemma~1]{dujmovic.wood:graph2007}
in some recursive embeddings.

\begin{lem}\lemlabel{dujwood}
   Every $k$-tree is either a clique on $k+1$ vertices or it contains a non-empty independent set $S$ and a vertex $u\not\in S$, such that:
\begin{enumerate}
   \item $G\setminus S$ is a $k$-tree;
   \item $\deg_{G\setminus S}(u)=k$; and 
   \item every element in $S$ is adjacent to $u$ and $k-1$ elements of
   $N_{G\setminus S}(u)$.
\end{enumerate}
\end{lem}

A graph $G$ is called a \emph{partial $k$-tree} if it is a subgraph of
some $k$-tree.  The class of partial $k$-trees is exactly the class of
graphs of treewidth at most $k$.  The class of partial 1-trees is the
class of forests.  All partial 2-trees are planar, every outerplanar graph
is a partial 2-tree, and every series-parallel graph is a partial 2-tree.
Not every 3-tree, and hence not every partial 3-trees is planar, since
$K_{3,3}$ is a 3-tree.

\subsection{Grid Obstacle Representations}

In this section we focus on $d_2$-obstacle embeddings.  Recall that these
are equivalent to the non-blocking planar grid obstacle representations
studied by Biedl and Mehrabi \cite{X}.  We begin with a positive result.

\subsubsection{Partial 2-trees have plane $d_2$-obstacle embeddings}

\begin{thm}\thmlabel{2-tree}
  Every partial 2-tree has a plane straight-line $d_2$-obstacle embedding.
\end{thm}

\begin{proof}
  Let $G$ be a partial 2-tree. We can, without loss of generality, assume
  that $G$ is connected.  If $|V(G)|< 4$, then the result is trivial, so
  we can assume $|V(G)|\ge 4$.  We now proceed by induction on $|V(G)|$.

  Let $T=T(G)$ be a 2-tree with vertex set $V(G)$ and that contains $G$.
  Apply \lemref{dujwood} to find the vertex set $S$ and the vertex $u$.
  Let $x$ and $y$ be the neighbours of $u$ in $T\setminus S$. Now apply
  induction to find a straight-line $d_4$ obstacle embedding of the
  graph $G'$ whose vertex set is $V(G')=V(G)\setminus S$ and whose edge
  set is $E(G')=E(G\setminus S)\cup\{ux,uy\}$.

  Now observe that, since $u$ has degree 2 in $G'$ and the edges $ux$
  and $uy$ are in $G'$, this embedding does not contain any monotone path
  of the form $uxw$ or $uyw$ for any $w\in V(G)\setminus\{u,x,y\}$.
  Therefore, if we place the vertices in $S$ sufficiently close to $u$,
  we will not create any monotone path of the form $ayw$ or $axw$ for
  any $a\in S$ and any $w\in V(G)\setminus \{u,x,y\}$.  What remains
  is to show how to place the elements of $S$ in order to avoid unwanted
  monotone paths of the form $uay$, $uax$, or $aub$ for any $a,b\in S$.
  There are three cases to consider (see \figref{2-tree-proof}):

  \begin{figure}
    \begin{tabular}{cccccc}
       \multicolumn{6}{c}{\includegraphics{figs/2tree-1}} \\
       \multicolumn{6}{c}{1(a)} \\
       \multicolumn{3}{c}{\includegraphics{figs/2tree-2}} & 
       \multicolumn{3}{c}{\includegraphics{figs/2tree-3}} \\
       \multicolumn{3}{c}{2(a)} &
       \multicolumn{3}{c}{2(c)} \\
       \multicolumn{2}{c}{\includegraphics{figs/2tree-4}} &
       \multicolumn{2}{c}{\includegraphics{figs/2tree-5}} &
       \multicolumn{2}{c}{\includegraphics{figs/2tree-6}} \\
       \multicolumn{2}{c}{3(a)} &
       \multicolumn{2}{c}{3(b)} &
       \multicolumn{2}{c}{3(c)} 
    \end{tabular}
  \caption{The proof of \thmref{2-tree}.}
  \figlabel{2-tree-proof}
  \end{figure}
  
  \begin{enumerate}

  \item  $x\in Q_i(u)$ and $y\in Q_{i+2}(u)$ for some
  $i\in\{0,\ldots,3\}$. Without loss of generality, assume that
  $Q_{i+3}(u)$ does not intersect the segment $xy$. Then we can embed the
  elements of $S$ in $Q_{i+3}$ without creating any new monotone paths.

  \item $x,y\in Q_i(u)$ for some $i\in\{0,\ldots,3\}$. There are two
  subcases:
    \begin{enumerate}
      \item At least one of $ux$ or $uy$ is in $E(G)$. Suppose $ux\in E(G)$.
      Then we embed $S_x$ in $Q_i(u)$ and embed $S_y$ in $Q_{i+1}(u)$.
      The only monotone paths this creates are of the form $uax$ with
      $a\in S_x$, which is acceptable since $ux\in E(G)$.
      \item Neither $ux$ nor $uy$ is in $E(G)$. In this case, we embed all
    of $S$ in $Q_{i+2}(u)$.  This does not create any new monotone paths.
    \end{enumerate}

  \item $x\in Q_i(u)$ and $y\in Q_{i+1}(u)$ for some $i\in\{0,\ldots,3\}$.
  We have two subcases to consider:
    \begin{enumerate}
      \item $|\{ux,uy\}\cap E(G)|=1$.  In this case, assume $ux\in
      E(G)$. Then we embed the vertices of $S_x$ in $Q_i(u)$ and we
      embed the vertices of $S_y$ in $Q_{i+3}(u)$.  The only monotone
      paths this creates are of the form $uax$ with $a\in S_x$, which
      is acceptable since $ux\in E(G)$.
      \item $|\{ux,uy\}\cap E(G)|=2$.  In this case we embed the
      vertices of $S_x$ in $Q_i(u)$ and we embed the vertices of $S_y$
      in $Q_{i+1}(u)$.  The only monotone paths this creates are of the
      form $uax$ with $a\in S_x$ and $uby$ with $b\in S_y$, which is
      acceptable since $ux,uy\in E(G)$.
      \item $|\{ux,uy\}\cap E(G)|=0$.  In this case, we embed all of
      $S$ into $Q_{i+2}\cup Q_{i+3}$.  This does not create any new
      monotone paths.
    \end{enumerate}
  \end{enumerate}
This completes the proof.
\end{proof}

\subsubsection{3-Trees do not have plane $d_2$-obstacle embeddings}

Here we establish the bad news: 3-trees do not have plane $d_2$-obstacle
embeddings.  The following lemma is easily established by a short case
analysis:

\begin{lem}\lemlabel{labelling}
  The vertices of any triangle $xyz$ can be labelled so that $y,z\in Q^4_i(x)$ for some $i\in\{0,\ldots,3\}$.
\end{lem}

A (1-level) \emph{subdivision} of a triangle $xyz$ is obtained by adding a
vertex $w$ in the interior of $xyz$ and adding the edges $wx$, $wy$, $wz$.
A $d$-level subdivision of $xyz$ is obtained by repeating this process
recursively to a depth of $d$.

\begin{lem}\lemlabel{level-1}
   Let $G$ be a plane $d_2$-obstacle embedding of some graph, and let $xyz$
   be a three-cycle in $G$ embedded with $x\in Q^4_i(y)$ and $z\in Q^4_i(x)$.
   Then $xyz$ does not contains a 3-level subdivision in its interior.
\end{lem}

\begin{proof}
   Without loss of generality assume that $i=0$ and $x$ is above the edge
   $yz$ Consider the location of the vertex $w$ that subdivides $xyz$.
   There are three cases to consider:
   \begin{enumerate}
      \item The vertex $w$ is placed in $Q^4_0(x)$.  In this case,
        there will be a 2-monotone path from $z$ to the vertex $w'$ that
        subdivides $xyw$.
      \item The vertex $w$ is placed in $Q^2_0(x)$.  In this case,
        there will be a 2-monotone path from $y$ to the vertex $w'$ that
        subdivides $xwz$.
      \item The vertex $w$ is placed in $Q^4_3(x)$. In this case,
      consider the vertex $w'$ that subdivides $zwy$.  The preceding
      two arguments prevent $w'$ from being placed in $Q^4_0(w)$
      or $Q^4_2(w)$.  However, placing $w'$ in $Q^4_3(w)$ creates a
      monotone path from $x$ to $w'$.
   \end{enumerate} 
\end{proof}

\begin{lem}\lemlabel{level-2}
   Let $G$ be a plane $d_2$-obstacle embedding of some graph, and let
   $xyz$ be a three-cycle in $G$ with $yz\in Q_i(x)$ for some $i$.
   Then $xyz$ does not contains a 4-level subdivision in its interior.
\end{lem}

\begin{proof}
   If $xyz$ does not already meet the criteria for \lemref{level-1}, then
   any choice of location for the first-level subdivision vertex will create
   at least one triangle that does meet the criteria for \lemref{level-1}.
\end{proof}

\begin{thm}\thmlabel{stellated}
   The graph $G$ that is a 5-level subdivision of a triangle does not
   have a non-blocking grid obstacle representation.
\end{thm}

\begin{proof}
   In any embedding of $G$, there is a triangle $xyz$ with a 4-level
   subdivision in its interior.  The theorem then follows since, by
   \lemref{labelling}, we can apply \lemref{level-1} to $xyz$.
\end{proof}

We note that the graph in \thmref{stellated} is a planar 3 tree.
Thefore, Theorems~\ref{thm:2-tree} and \ref{thm:stellated} tell us that
all planar graph of treewidth at most 2 have plane $d_2$-obstacle embeddings,
but not all planar graph of treewidth 3 do.

\begin{figure}
   \begin{center}
      \includegraphics[width=\textwidth]{figs/triangular-grid}
   \end{center}
   \caption{A $d_2$-obstacle embedding of the hexagonal grid.}
\end{figure}


Although some planar graphs of treewidth 3 do not have $d_2$-obstacle
embeddings, the infinite hexagonal grid (and hence every induced subgraph
of this grid) has a plane $d_2$-obstacle embedding.  This embedding
is shown in \figref{hexagonal}.  This means that there are $n$-vertex
planar graphs of treewidth $\Theta(\sqrt{n})$ that have $d_2$-obstacle
embeddings, so perhaps treewidth is not the most important parameter.

\subsection{4-Connected triangulations do not have plane $d_2$-obstacle embeddings}

Talk about skinny triangles and why 4-connected might work instead.


One as aspect of 3-trees that stands out is that 3-trees tend to incluce, and that is used in the proof that they do not have 

\subsection{Hexagon Grid Obstacle Representations}
 
Next, we study plane $d_3$-obstacle embeddings.

\begin{thm}\thmlabel{3-tree}
  Every planar graph of treewidth at most 3 has a plane $d_3$-obstacle embedding.   
\end{thm}

\subsection{Planar graphs have plane $d_{X}$ obstacle embeddings}

\section{Graph Metrics}

For a graph $H$, let $d_H$ denote the graph distance and let $C_H$ denote
the set of curves that define paths in $H$.  For a graph $H$, we call
a $(H,d_H,C_H)$ obstacle representation an $H$ obstacle representation

If we consider the infinite square grid $H_4$, then it is not
difficult to argue that a graph $G$ has an non-crossing $H_4$ obstacle
representation if and only if $G$ has a plane $d_2$ obstacle embedding.
Similarly, if we consider the infinite triangular grid $H_6$, then $G$
has a non-crossing $H$ obstacle representation if and only if $G$ has a
plane $d_3$-obstacle representation.  In this way, Theorems~\ref{thm:2-tree}
and \ref{thm:3-tree} tell us that every planar graph or treewidth at most 2
or treewidth at most 3 has a non-crossing $H_4$ or non-crossing $H_6$
obstacle representations, respectively.

Another natural graph to consider for obstacle representations is the
$D$-cube, $Q_D$, whose vertex set is $V(Q_D)=\{0,1\}^D$ and that contains
the edge $uw$ if and only $u$ and $w$ differ in exactly one coordinate.

It is not hard to see that every $n$ vertex graph has a $Q_n$ obstacle
representation: Each vertex of $G$ is assigned a coordinate with a
single 1 bit.  Then, for any two vertices $u$ and $w$ there are exactly
two shortest paths in $Q_n$ joining them and they each have length 2.
One path goes through the intermediate vertex $\mathbf{0}=(0,\ldots,0)$
and the other goes throught $u+w$.  Therefore by placing an obstacle at
$\mathbf{0}$ and at each $u+w$ for which $uw\not\in E(G)$, we obtain a
$Q_D$ obstacle representation of $G$.  The following theorem shows we
can do this with much fewer coordinates:

\begin{thm}\thmlabel{hypercube}
  There exists a constant $c>0$ such that, for $D=c\log n$, every $n$-vertex graph has a $Q_D$ obstacle representation.
\end{thm}

\begin{proof}
   Consider an embedding $(\varphi,c)$ of $G$ into $Q_n$ obtained by
   taking, for each $u\in V(G)$, $\varphi(u)$ to be a random element of
   $\{0,1\}^D$.  We use the notation $u_i$ to denote the $i$th coordinate
   of $u$.

   Let $\prec$ denote lexicographic order.  For each edge
   $uw\in E(G)$ with $u\prec w$, we take $c(uw)$ to be the
   \emph{greedy} path that visits, for $i=0,\ldots,D$, the vertex
   $uw_i=(w_1,\ldots,w_i,u_{i+1},\ldots,u_D)$.  Thus $uw_0,\ldots,uw_D$
   is a sequence of vertices that, after removing duplicates is a
   shortest path, in $Q_D$, from $u$ to $w$.  Note that there is an
   asymmetry here that we should be careful of, so for $u\prec w$,
   we define $wu_i=w_1,\ldots,w_{D-i},u_{D-i+1},\ldots,u_{D}=uw_{D-i}$.
 
   Let us make some observations about this embedding.
   \begin{enumerate}
      \item All vertex distances are close to $D/2$:
       The distance between any two vertices is a
       binomial$(D,1/2)$ random variable.  Therefore, by Chernoff's
       bounds, for any constant $\eps>0$ and for any vertex pair $u\neq
       w$, $\Pr\{|d_{Q_D}(u,w)-D/2| > \eps(D/2)\} \le n^{-\Omega(c)}$.  By the
       union bound, the probability that there exists any pair of vertices
       $u\neq w$ with $|d_{Q_D}(u,w)-D/2| > \eps(D/2)$ is also $n^{-\Omega(c)}$.

      \item The embedding is non-crossing: For any four distinct vertices
      $u\prec w$ and $x\prec y$, and any $i,j\in\{0,\ldots,D\}$, the
      vertices $uw_i$ and $uw_j$ are indepedent random $D$-bit strings.
      Therefore, $\Pr\{d_{Q_D}(uw_i,xy_j)\le 1\} \le (D+1)/2^{D}$.
      By the union bound, the probability that there exists any four
      vertices and any pair of indices for which this does not hold is
      at most $n^4(D+1)^3/2^{D}$.

     \item No geodesic passes close to a vertex except its endpoints:
      Let $u$, $w$, and $x$ be distinct vertices.  Then, the probability
      that there exists any geodesic with endpoints $u$ and $w$
      that passes through a vertex $z$ with $d_{Q_D}(z,x)\le r$ is at most
      $n^{-\Omega(c)}$.  To see why this is so, suppose $C$ contains a
      vertex $z$ such that $d_{Q_D}(z,x) \le r$.  Then at least one of
      the following events occurs:
     \begin{enumerate}
       \item $d_{Q_D}(u,w) \ge (1+\eps)D/2$, 
       \item $d_{Q_d}(u,x) \le (1+\eps)D/4+r$
       \item $d_{Q_d}(w,x) \le (1+\eps)D/4+r$
     \end{enumerate}
     Point 1, above establishes that the probability of the first event is
     $n^{-\Omega(c)}$ and that, for $r\le (1-3\eps)D/4$, the probability
     of each of the other two events is $n^{-\Omega(c)}$.  Applying the
     union bound over all 3 events, and over all $\binom{n}{3}$ choices
     of $u$, $w$, and $x$ then shows that the probability that there
     is any triple $u$, $w$, $x$ such that any geodesic from $u$ to $w$
     passes within distance $(1-3\eps)D/4$ of $x$ is $n^{-\Omega(c)}$.


     \item Paths diverge quickly:
      Let $xu,xw\in \E(G)$, be two edges of $G$ with the common endpoint
      $x$ and let $i\in\{0,\ldots,D\}$.  We want to show that the
      directed paths $xu$ and $xw$ diverge quickly.  There are three
      cases to consider:
     \begin{enumerate}
        \item $x\prec u$ and $x\prec w$.  In this case $xu_r=xw_r$ if and
        only if $u_1,\ldots,u_r=w_1,\ldots,w_r$, so $\Pr\{xu_r=xw_r\}=
        2^{-r}$.

        \item $x\prec u$ and $w\prec x$.  In this, we
        consider $xu_r=u_1,\ldots,u_r,x_{r+1},\ldots,x_D$ and
        $xw_r=wx_{D-r}=x_1,\ldots,x_{D-r},w_{D-r+1},\ldots,w_D$. For
        any choice of $i$, these two strings have independent bits in
        at least $i$ locations, so $\Pr\{xu_r=xw_r\}\le 2^{-r}$.

        \item $u\prec x$ and $w\prec x$. In this case
        $xu_r=ux_{D-r}=x_1,\ldots,x_{D-r},u_{D-r+1},\ldots,u_D$ and
        $xw_r=wx_{D-r}=x_1,\ldots,x_{D-r},w_{D-i+1},\ldots,w_D$. So
        $\Pr\{xu_r=xw_r\}=2^{-r}$.
     \end{enumerate}
     If we choose $r=a\log n$, then this probability is at most
     $n^{-\Omega(a)}$. Again, the union bound shows that the probability
     that there is any $u$, $w$, or $x$ such that $xu_r=xw_r$ is at
     most $n^{-\Omega(a)}$.
    \end{enumerate}
    Therefore, by choosing a sufficiently large constants $a$ and $c$,
    we obtain, with probability greater than 0, an embedding for which
    all four of preceding properties hold.  Therefore, there exists some
    embedding $(\varphi, c)$ for which these properties hold.

    To obtain a $Q_D$ obstacle representation $(\varphi,S)$ we take $S$
    to contain all the vertices not used in the embedding $(\varphi,
    c)$ in any path of the embedding.  To verify that this is indeed an
    obstacle representation, we need only verify that that, for any $u,w$
    with $uw\not\in E(G)$, $Q_D\setminus S$ does not contain a path from
    $u$ to $w$ of length $d_{Q_D}(u,w)$.

    Suppose that such a path $P$ did exist.  Let $ux\in E(G)$ be the path
    for which $c(ux)$ has the longest prefix in common with $P$.  (Property~3 ensures that an edge $ux$ exists.)  At some point $P$ diverges from $ux$ and joins some other path $c(ab)$ with $a\neq u$.  By Property~2, $a,b\neq blah\ldots$
\end{proof}

It is worth nothing that \thmref{hypercube} is closely related to
\thmref{3d-universal}.  Indeed, before perturbing it, the point set
$X$ used in the proof of \thmref{3d-universal} is a projection of
the vertices of $Q_{D}$ with $D=\lceil\log_2 n\rceil$ onto $\R^3$.
In \thmref{3d-universal} we then perturb $X$ to obtain a non-crossing
embedding.  In the proof of \thmref{hypercube} we have to be more careful
to avoid crossings.

Question: Is it NP-hard, given $G$ and $H$, to decide if $G$ has an $H$ obstacle representation?

\bibliographystyle{plain}
\bibliography{geoobs}

\end{document}


