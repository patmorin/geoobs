\documentclass{patmorin}
\listfiles
\usepackage[utf8]{inputenc}
\usepackage{microtype}
\usepackage{amsthm,amsmath,graphicx}
\usepackage{pat}
\usepackage[letterpaper]{hyperref}
\usepackage[table,dvipsnames]{xcolor}
\definecolor{linkblue}{named}{Blue}
\hypersetup{colorlinks=true, linkcolor=linkblue,  anchorcolor=linkblue,
citecolor=linkblue, filecolor=linkblue, menucolor=linkblue,
urlcolor=linkblue} 
\setlength{\parskip}{1ex}
\usepackage{wasysym}

\title{\MakeUppercase{Bent Drawings}}

\author{Pat Morin and Friends}%

%\usepackage[mathlines]{lineno}
%\linenumbers
%\setlength{\linenumbersep}{2.5cm}
%\rightlinenumbers
%\linenumbers
%\newcommand*\patchAmsMathEnvironmentForLineno[1]{%
%  \expandafter\let\csname old#1\expandafter\endcsname\csname #1\endcsname
%  \expandafter\let\csname oldend#1\expandafter\endcsname\csname end#1\endcsname
%  \renewenvironment{#1}%
%     {\linenomath\csname old#1\endcsname}%
%     {\csname oldend#1\endcsname\endlinenomath}}% 
%\newcommand*\patchBothAmsMathEnvironmentsForLineno[1]{%
%  \patchAmsMathEnvironmentForLineno{#1}%
%  \patchAmsMathEnvironmentForLineno{#1*}}%
%\AtBeginDocument{%
%\patchBothAmsMathEnvironmentsForLineno{equation}%
%\patchBothAmsMathEnvironmentsForLineno{align}%
%\patchBothAmsMathEnvironmentsForLineno{flalign}%
%\patchBothAmsMathEnvironmentsForLineno{alignat}%
%\patchBothAmsMathEnvironmentsForLineno{gather}%
%\patchBothAmsMathEnvironmentsForLineno{multline}%
%}


\newcommand{\question}[1]{\textbf{\color{red}Question:}~#1}

\DeclareMathOperator{\ob}{obs}
\DeclareMathOperator{\planeobs}{plane-obs}

\newcommand{\eps}{\epsilon}

%\pagenumbering{roman}
\begin{document}
%\begin{titlepage}
\maketitle
%
\begin{abstract}
  We prove that every planar graph has a straight-line plane drawing that is ``bent'' in the following sense: The set of directions $[0,2\pi)$ can be partitioned into 40 intervals such that any walk of length greater than 1 traverses edges in directions from at least two of these 40 intervals.
\end{abstract}
%\end{titlepage}
%
%\tableofcontents
%
%\newpage


\section{Introduction}
\pagenumbering{arabic}

A \emph{geometric graph} is a graph whose vertices are points in $\R^2$
and whose edges are represented as line segments joining their endpoints.
A walk $w_0,\ldots,w_r$ in $G$ can be thought of a sequence of vectors
$v_1,\ldots,v_r$, where $v_i=w_i-w_{i-1}$ and each of these vectors has
a direction $\alpha_i\in[0,\ldots,2\pi)$ equal to the (counterclockwise)
angle $v_i$ makes with the x-axis.  Given a partition $D$ of $[0,2\pi)$,
we say that the walk is $D$-bent if, for some $i,j\in\{1,\ldots,r\}$,
$i\neq j$,  $\alpha_i\in I$ and $\alpha_j\in J$ for some $I,J\in D$,
$I\neq J$. The graph $G$ is $D$-bent if every walk of length 2 is
$D$-bent.  In words, $G$ is $D$-bent if every walk of length at least
2 travels in at least two of the classes of directions defined by $D$.

For any $r\in\N$, let $D_r=\{[2i\pi/r,2(i+1)\pi/r): i\in
\{0,\ldots,r-1\}\}$.  Then we say that $G$ is $r$-bent if it is $D_r$-bent.
We prove the following result:

\begin{thm}\thmlabel{bent}
  Every planar graph $G$ has a plane embedding that is $40$-bent.
\end{thm}

Our proof of \thmref{bent} actually implies a stronger result:

\begin{lem}
  For any $\epsilon>0$, every planar graph $G$ has a plane embedding that is 40-bent and such that the direction of any edge is in the range $[2(i+1/2-\epsilon)\pi/40,2(i+1/2+\epsilon)\pi/40]$, for some $i\in\{0,\ldots,39\}$.
\end{lem}

The preceding strengthening implies that the angle between any two
consecutive steps in any walk in the embedding of $G$ is at least
$\pi/20-2\epsilon$.  This, in turn implies a lower-bound on the length
of the Euclidean shortest path between any two non-adjacent vertices in
the embedding.

\section{The Proof}

\subsection{Directions}

Let $K=36$.  For each $i\in\{1,\ldots,K/2\}$, define $C_i=[2\pi
(i-1)/K,2\pi i/K)$ and, for any $\epsilon < \pi/K$ let $C_i^\epsilon
= \{[2\pi (i-1/2-\epsilon)/K,2\pi(i-1/2+\epsilon)/K)$.  We treat the
sets $C_i$ and $C_i^\epsilon$ as sets of directions. We say that a line
segment has a direction in $C_i$ if, after translating so that its lowest
leftmost endpoint to the origin, the angle it makes with the x-axis is in
the interval $C_i$.  We call a direction \emph{odd} if it is contained
in some $C_i$ for odd $i$, and even otherwise.  We call a line segment
even or odd depending on whether its direction is even or odd.

\begin{figure}
  \begin{center}
     \includegraphics{figs/directions}
  \end{center}
  \caption{The sets $C_1,\ldots,C_{18}$ and $C_1^{\epsilon},\ldots,C_{18}^\epsilon$ of directions.  The colour of $C_i^\epsilon$ indicates whether it is nearly horizontal, nearly-diagonal, or nearly-vertical.}
\end{figure}

A set of line segments are \emph{nearly-parallel} if there is some
$i\in\{1,\ldots,18\}$ such that each segment in the set is in direction
$C_i^{\epsilon}$.  A line segment is \emph{nearly-horizontal} if its
direction is in $C_i^\epsilon$ for some $i\in\{1,2,3,4,15,16,17,18\}$;
it is nearly vertical if its direction is in $C_i^\epsilon$ for some
$i\in\{9,10\}$, and it is nearly-diagonal if its direction is in
$C_i^\epsilon$ for some $i\in\{5,6,7,8,11,12,13,14\}$.

\subsection{Shapes}


A \emph{near-rectangle} is a 4-gon with two nearly-horizontal sides,
called the \emph{top} and \emph{bottom} and with the property that every
segment joining a point on the top to a point on the bottom is nearly
vertical and all such segments are nearly parallel.  A \emph{v-triangle}
is a degenerate near-rectangle in which exactly one of the top or bottom
sides contains a single point.  We use the convention that a near-rectangle is specified by a 4-tuple $(a,b,c,d)$ that lists its vertices in clockwise order, starting with the left endpoint of its top side.

%A \emph{near-parallelogram} is a 4-gon with two nearly-horizontal
%nearly-parallel sides, called the \emph{top} and \emph{bottom} and with
%the property that all segments joining a point on the top to a point on
%the bottom are nearly-diagonal and nearly-parallel.  A \emph{d-triangle}
%is a degenerate near-parallelogram in which exactly one of the top or bottom
%sides contains a single point.
%
%A \emph{near-block} is a 4-gon with two nearly-horizontal nearly-parallel
%sides, called the top and bottom with the property that, for some
%$x\in\{0,\ldots,3\}$, the segment joining the left endpoints of the
%top and bottom has a direction in $C_{5+x}^\epsilon$ and the segment
%joining the right endpoints of the top and bottom has a direction in
%$C_{14-x}^\epsilon$.  A \emph{dd-triangle} is a degenerate near-block
%in which the top side consists of a single point.
%
%A \emph{flat-triangle} is a triangle with ....
%
Any one of the shapes described in this section is called \emph{odd}
if all its sides are odd and \emph{even} if all its sides are even.

\subsection{The Algorithm}

A \emph{near-triangulation} is a combinatorially embedded 2-connected planar
graph all of whose inner faces are bounded by three edges.
We now describe our algorithm for produces a bent-drawing of a
near-triangulation $G$ whose outer face has vertices $v_1,\ldots,v_r$
in clockwise order.  The algorithm is recursive and is given, as input,
given an odd or even shape, $S$, as well a mapping of
$v_1,\ldots,v_r$ onto the vertices and flat edges of $S$.
TODO: explain this mapping more. TODO: The flat-triangle is an exception.

Suppose the shape $S$ is odd.  Then we will produce a drawing of $G$
in which each $v_i$ is drawn on the vertex it is mapped to or arbitrarily close to the edge it is mapped to.


 is drawn arbitrarily close to the object (edge or
vertex) of $S$ that it is mapped onto and such that every edge of $G$
incident to at least one of $v_1,\ldots,v_r$ is odd.


\subsection{A Useful Tool}

\begin{lem}\lemlabel{outerplanar-fancy}
   Let $G$ be an outerplanar graph on vertex set $u_1,\ldots,u_r$ and such that $u_1,\ldots,u_r$ is a path on the outer face of $G$.  Let $w_1,\ldots,w_s$ denote the subsequence of $u_1,\ldots,u_r$ containing $w_1=u_1$, $w_s=u_r$, as well as all cut vertices of $G$.  Let $i_1=1,\dots,i_t=s$ be any stricly increasing sequence of indices over $\{1,\ldots,s\}$. Let $a$ and $b$ be the endpoints of a line segment whose direction is $C_i$ for some $i\in\{1,3\}$.  
   Then, for any $\delta>0$,
   there exists a $K$-bent drawing of $G$ such that 
\begin{enumerate}
   \item $v_1=a$ and $v_2=b$.
   \item $v_1,\ldots,v_r$ is an x-monotone path above the segment $ab$; 
   \item every edge of the drawing is an odd nearly-horizontal line segment;
   \item for each $1\le i<j<k\le s$, $\|w_jw_k\|\le \delta\|w_{i}w_k\|$; and
   \item for each $\ell\in\{1,\ldots,t-1\}$ and each $j\in\{i_{\ell+1},\ldots,i_{\ell+1}-1\}$,
     $\|w_{i_\ell}w_j\| \le \delta\|w_{i_\ell}w_{i_{\ell+1}}\|$.
   \item every inner face of the drawing is a nearly-flat triangle. TODO: Define.
\end{enumerate}
\end{lem}

Before proving \lemref{outerplanar-fancy}, we attempt to offer some
intuition about 
Conditions~4 and 5: The indices
$i_1,\ldots,i_t$ mark \emph{special} vertices.  Condition~4 states
that, in any interval $w_{i_a},\ldots,w_{i_b}$, of special vertices,
the special vertices $w_{i_a+1},\ldots,w_{i_b-1}$ in the interior
of this interval are clustered around the right endpoint, $w_{i_b}$
of the interval.  Condition~5 says that non-special vertices in any
interval $w_{i_{\ell}},w_{i_{\ell+1}}$ are clustered around the left
endpoint $w_{i_\ell}$ of the interval.

\begin{proof}
  First, complete $G[W]$ to an edge-maximal outerplane graph $H$ as follows:
\begin{enumerate}
  \item add the edges of the path $w_{i_1},\ldots,w_{i_t}$;
  \item add edges from $v_1$ to each of $w_{i_1},\ldots,w_{i_t}$;
  \item for each $\ell\in\{2,\ldots,t\}$ add an edge from $w_{i_\ell}$ to each of $w_{i_{\ell-1}+1},\ldots,w_{i_\ell-1}$. 
\end{enumerate}
  Run the algorithm described above to obtain a drawing of $H$.  Now we
  repeat the following steps as long as $V(H)\neq V(G)$: find an inner
  face of $G$ that is incident to an edge of $H$ but contains at least
  one vertex not in $H$. Add all vertices and edges of $F$ to $H$ and
  make them adjacent to the lower endpoint of $H$. Now rerun the drawing
  algorithm on (the new, larger, graph) $H$.

  This algorithm finishes and produces a $K$-bent drawing of $H$ and
  removing edges of $H$ not in $G$ gives the desired $K$-bent drawing
  of $G$.  TODO: Prove more.
\end{proof}

Note that there are several other variants of
\lemref{outerplanar-fancy}: If $i\in\{15,17\}$, then we obtain
an embedding in which Property~4 is slighly different so that
$w_{i_\ell},w_{i_\ell+1},\ldots,w_{i_{\ell+1}-1}$ are clustered close
to $w_{i_{\ell+1}}$ instead of $w_{i_\ell}$. In our application of
\lemref{outerplanar-fancy} this difference is unimportant.

if $i\in\{2,4,16,18\}$, then \lemref{outerplanar-fancy} gives an embedding
of $G$ in which every edge is \emph{even} instead of odd.  And, of course,
the algorithm can produce drawings in which all vertices are below the
segment as well.  In the following, we will apply the algorithm to obtain
all these kinds of embeddings.




\subsection{Drawing onto a Near-Rectangle}


\begin{lem}
   Let $R(a,b,c,d)$ be an odd (respectively, even) near-rectangle and
   let $G$ be a near triangulation whose outer face, in clockwise order
   is $v_1,\ldots,v_r$.  Then, for any $1<j<r-1$, there exists a $K$-bent
   drawing of $G$ such that
\begin{enumerate}
   \item $v_1=a$, $v_j=b$, $v_{j+1}=c$, and $v_r=d$;
   \item the paths $v_1,\ldots,v_j$ and $v_{j+1},\ldots,v_r$ are each x-monotone and use only nearly-horizontal edges;
   \item every edge incident to at least one of $v_1,\ldots,v_r$ is odd.
\end{enumerate}
\end{lem}

\begin{proof}
  Let $C=\{v_1,\ldots,v_r\}$. Call the vertices $v_1,\ldots,v_j$ \emph{top} vertices and call the vertices $v_{j+1},\ldots,v_r$ \emph{bottom} vertices.

  First consider the outerplanar graph $B$ induced by the bottom
  vertices. We want to apply \lemref{outerplanar-fancy} to the graph
  $B$ to obtain an embedding of $B$ with $v_{j+1},\ldots,v_{r}$
  below the segment $cd$.  The clustering provided Properties~4 and
  5 of the resulting embedding is unimportant to us, so we only use
  an index sequence of length $t=2$ chosen so that $w_{i_1}=v_{j+1}$
  and $w_{i_2}=v_r$.

  Next we consider the outerplanar graph $T$ induced by the top vertices
  and use \lemref{outerplanar-fancy} to embed it above the segment $ab$.
  For this application of \lemref{outerplanar-fancy} we do care about
  the clustering provided by Property~4. In particular, we choose
  $i_2,\ldots,i_{t-1}$ so that it includes every top vertex that is 
  incident, in $G$, to a bottom vertex and any top vertex $v$ such that $G$
  contains a path $vxy$ such that $y$ is a bottom vertex and $x\not\in C$.

  These two embeddings of $T$ and $B$ give us an embedding of the
  outerplanar graph $G[C]$.  We claim that this embedding of $G[C]$ is
  bent and contains only odd edges.  Indeed, \lemref{outerplanar-fancy}
  already guarantees this for
  $T$ and $B$, which only have nearly-horizontal edges and the only other
  edges of $G[C]$ are nearly-vertical edges that are nearly-parallel to
  $ad$ and $bc$.

  This embedding of $G[C]$ has inner faces and some of these contain
  vertices of $G$ in their interior. Thus, it remains to show how to
  draw these parts of $G$.  There are two types of inner faces in the
  embedding of $G[C]$ (1)~those having no edges from a top vertex to
  a bottom vertex and (2)~those have both top and bottom vertices.
  To draw the parts of $G$ inside the first types of faces, we use
  \lemref{triangle-draw} below. We now show how to draw the parts of $G$
  inside the second types of faces.

  Consider some face $F$ of $G[C]$ that contains both top and bottom
  vertices and therefore contains exactly two edges joining a top vertex
  to a bottom vertex. These two edges are nearly-parallel to $ad$ and $bc$
  and are therefore odd near-vertical edges.  This means that the four or
  three endpoints of these two edges are the corners of a near-rectangle.
  We now focus on the subgraph $G_F$ of $G$ contains the edges and
  vertices that are inside of $F$ or on the boundary of $F$.
  

We do this by applying \lemref{outerplanar-fancy} with $G=B$, 

  We start by considering the induced graph $G[C]$, which is outerplanar.
  We say that an internal face of $G[C]$ is \emph{tall} if it has both
  top and bottom vertices on its boundary. 

\end{proof}


\end{document}


